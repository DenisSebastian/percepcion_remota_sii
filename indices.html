<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Centro de Inteligencia Territorial">
<meta name="dcterms.date" content="2023-05-09">

<title>Curso: Análisis de Imágenes Satelitales para SII - 7&nbsp; S5: Índices Espectrales</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tarea_1.html" rel="next">
<link href="./proc_gee.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.27/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="site_libs/clipboard-0.0.1/setClipboardText.js"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="styles/style.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">S5: Índices Espectrales</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Curso: Análisis de Imágenes Satelitales para SII</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objetivos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Objetivos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fundamentos_PR.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">S1: Percepción Remota</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./satelites_sensores.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">S2: Satélites y Sensores</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_gee.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">S3: Introducción a GEE</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./proc_gee.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">S4: Procesamiento con GEE</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./indices.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">S5: Índices Espectrales</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Tareas</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tarea_1.html" class="sidebar-item-text sidebar-link">Tarea 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tarea_2.html" class="sidebar-item-text sidebar-link">Tarea 2</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Referencias Bibliográficas</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introducción a R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variables_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Variables en R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./funciones.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Funciones en R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loops_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Estructura de Control en R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyverse_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Tidyverse en R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./espacial_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Objetos Espaciales en R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./install_rgee.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Instalación de Rgee</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="toc-section-number">7.1</span>  Introducción</a></li>
  <li><a href="#sec-indurb" id="toc-sec-indurb" class="nav-link" data-scroll-target="#sec-indurb"><span class="toc-section-number">7.2</span>  Índices Urbanos</a></li>
  <li><a href="#calculo-de-índices-de-urbanos" id="toc-calculo-de-índices-de-urbanos" class="nav-link" data-scroll-target="#calculo-de-índices-de-urbanos"><span class="toc-section-number">7.3</span>  Calculo de Índices de Urbanos</a>
  <ul class="collapse">
  <li><a href="#selección-de-área-de-estudio" id="toc-selección-de-área-de-estudio" class="nav-link" data-scroll-target="#selección-de-área-de-estudio"><span class="toc-section-number">7.3.1</span>  Selección de Área de Estudio</a></li>
  <li><a href="#sec-psat" id="toc-sec-psat" class="nav-link" data-scroll-target="#sec-psat"><span class="toc-section-number">7.3.2</span>  Selección Imagen Satelital</a></li>
  <li><a href="#sec-findex" id="toc-sec-findex" class="nav-link" data-scroll-target="#sec-findex"><span class="toc-section-number">7.3.3</span>  Aplicar Índice</a></li>
  <li><a href="#visualizar-resultados" id="toc-visualizar-resultados" class="nav-link" data-scroll-target="#visualizar-resultados"><span class="toc-section-number">7.3.4</span>  Visualizar Resultados</a></li>
  <li><a href="#calcular-un-índice" id="toc-calcular-un-índice" class="nav-link" data-scroll-target="#calcular-un-índice"><span class="toc-section-number">7.3.5</span>  Calcular un índice</a></li>
  <li><a href="#corrección" id="toc-corrección" class="nav-link" data-scroll-target="#corrección"><span class="toc-section-number">7.3.6</span>  Corrección</a></li>
  <li><a href="#histograma-de-ndvi" id="toc-histograma-de-ndvi" class="nav-link" data-scroll-target="#histograma-de-ndvi"><span class="toc-section-number">7.3.7</span>  Histograma de NDVI</a></li>
  <li><a href="#sec-vismap" id="toc-sec-vismap" class="nav-link" data-scroll-target="#sec-vismap"><span class="toc-section-number">7.3.8</span>  Visualización espacial de NDBI</a></li>
  <li><a href="#guardar-los-resultados" id="toc-guardar-los-resultados" class="nav-link" data-scroll-target="#guardar-los-resultados"><span class="toc-section-number">7.3.9</span>  Guardar los resultados</a></li>
  </ul></li>
  <li><a href="#monitoreo-de-sequía-laguna-de-aculeo" id="toc-monitoreo-de-sequía-laguna-de-aculeo" class="nav-link" data-scroll-target="#monitoreo-de-sequía-laguna-de-aculeo"><span class="toc-section-number">7.4</span>  Monitoreo de Sequía Laguna de Aculeo</a>
  <ul class="collapse">
  <li><a href="#el-problema" id="toc-el-problema" class="nav-link" data-scroll-target="#el-problema"><span class="toc-section-number">7.4.1</span>  El Problema</a></li>
  <li><a href="#lectura-de-insumo-cuerpos-de-agua-nacional" id="toc-lectura-de-insumo-cuerpos-de-agua-nacional" class="nav-link" data-scroll-target="#lectura-de-insumo-cuerpos-de-agua-nacional"><span class="toc-section-number">7.4.2</span>  Lectura de Insumo Cuerpos de Agua Nacional</a></li>
  <li><a href="#lectura-de-insumo-satelital-visualización-previa" id="toc-lectura-de-insumo-satelital-visualización-previa" class="nav-link" data-scroll-target="#lectura-de-insumo-satelital-visualización-previa"><span class="toc-section-number">7.4.3</span>  Lectura de insumo satelital visualización previa</a></li>
  <li><a href="#construcción-de-un-mosaico-con-ndwi-y-falso-color" id="toc-construcción-de-un-mosaico-con-ndwi-y-falso-color" class="nav-link" data-scroll-target="#construcción-de-un-mosaico-con-ndwi-y-falso-color"><span class="toc-section-number">7.4.4</span>  Construcción de un Mosaico con NDWI y Falso Color</a></li>
  <li><a href="#creación-de-serie-anual-desde-el-2015-al-2020" id="toc-creación-de-serie-anual-desde-el-2015-al-2020" class="nav-link" data-scroll-target="#creación-de-serie-anual-desde-el-2015-al-2020"><span class="toc-section-number">7.4.5</span>  Creación de Serie Anual desde el 2015 al 2020</a></li>
  </ul></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="toc-section-number">7.5</span>  Referencias</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">S5: Índices Espectrales</span></h1>
<p class="subtitle lead">Índices Espectrales con R y Rgee</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Centro de Inteligencia Territorial </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 9, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introducción" class="level2 page-columns page-full" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="introducción"><span class="header-section-number">7.1</span> Introducción</h2>
<p>Los índices espectrales son herramientas utilizadas en percepción remota para analizar la reflectancia de la superficie terrestre en diferentes longitudes de onda del espectro electromagnético. Estos índices se basan en la relación entre la reflectancia en dos o más bandas espectrales y se utilizan para medir diferentes propiedades de la vegetación, como la salud, la humedad y la densidad.</p>
<p>La más común formula matemática de diferencia normalizada es la siguiente:</p>
<p><span class="math display">\frac{(B_x-B_y)}{(B_x+B_y)}</span> En términos prácticos, se trata de la diferencia entre dos bandas seleccionadas normalizada por su suma. Este tipo de cálculo es muy útil para minimizar (en la medida de lo posible) los efectos de la iluminación (sombras en regiones montañosas, sombras de nubes, etc.) y mejorar las características espectrales que inicialmente no son visibles.</p>
<div id="fig-ndviLeaf" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="imagenes/ndvi_index.png" class="img-fluid figure-img" width="400"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;7.1: NDVI (Índice de Vegetación de Diferencia Normalizada)</figcaption><p></p>
</figure>
</div>
<p>Algunos de los índices espectrales más utilizados son:</p>
<ul>
<li><strong>NDVI (Índice de Vegetación de Diferencia Normalizada)</strong>: Este índice se utiliza para medir la salud y densidad de la vegetación. Se calcula utilizando la reflectancia en la banda roja y la banda infrarroja cercana. Un valor alto de NDVI indica una vegetación densa y saludable (<a href="#fig-ndviLeaf">Figure&nbsp;<span>7.1</span></a>).</li>
<li><strong>EVI (Índice de Vegetación Mejorado)</strong>: Este índice también se utiliza para medir la salud y densidad de la vegetación, pero tiene en cuenta factores como la influencia del suelo y la atmósfera. Se calcula utilizando la reflectancia en la banda azul, roja e infrarroja cercana.</li>
<li><strong>SAVI (Índice de Vegetación Ajustado para Suelo)</strong>: Este índice se utiliza para reducir la influencia del suelo en la medición de la vegetación. Se calcula utilizando la reflectancia en la banda roja y la infrarroja cercana y tiene en cuenta la cantidad de luz reflejada por el suelo.</li>
<li><strong>NLI (Índice de Línea de Agua Normalizado)</strong>: Este índice se utiliza para medir la cantidad de agua en una superficie. Se calcula utilizando la reflectancia en la banda verde y la banda infrarroja cercana.</li>
<li><strong>NDWI (Índice de Agua Normalizado)</strong>: Este índice también se utiliza para medir la cantidad de agua en una superficie, pero tiene en cuenta la reflectancia en la banda del infrarrojo de onda corta y la banda verde.</li>
</ul>
<p>Estos índices espectrales son solo algunos ejemplos de las muchas herramientas disponibles para analizar la vegetación y el agua utilizando percepción remota.</p>
</section>
<section id="sec-indurb" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sec-indurb"><span class="header-section-number">7.2</span> Índices Urbanos</h2>
<p>Algunos ejemplos de índices espectrales normalizados utilizados para analizar el entorno urbano con percepción remota son:</p>
<ul>
<li><strong>NDBI (Índice de Brillo de la Edificación Normalizado)</strong>: Este índice se utiliza para identificar y mapear áreas urbanas construidas. Se calcula utilizando la reflectancia en la banda del infrarrojo cercano y la banda del rojo.</li>
<li><strong>SI (Índice de Suelo)</strong>: Este índice se utiliza para detectar y mapear la presencia de suelo desnudo en áreas urbanas. Se calcula utilizando la reflectancia en la banda del rojo y la banda del infrarrojo cercano.</li>
</ul>
<p>Estos índices espectrales normalizados pueden ser útiles para el análisis de la planificación urbana, la gestión del medio ambiente y otros fines relacionados con la ciudad.</p>
<p>Haciendo uso de proyecto <a href="https://github.com/awesome-spectral-indices/espectro">awesome spectral indices</a> que ofrece a los usuarios las herramientas para consultar índices espectrales y las bandas requeridas para el cálculo de un índice. Incluso cuentan con <a href="https://davemlz-espectro-espectro-91350i.streamlit.app">Aplicación web</a></p>
</section>
<section id="calculo-de-índices-de-urbanos" class="level2 page-columns page-full" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="calculo-de-índices-de-urbanos"><span class="header-section-number">7.3</span> Calculo de Índices de Urbanos</h2>
<p>Cargar Librerías</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgee)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ee_Initialize</span>(<span class="st">'denis.berroeta@gmail.com'</span>, <span class="at">drive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ![Aplicación de Awesome Spectral Indices](imagenes/espectro_app.gif){fig-align="center" width="600"} -->
<p>Si seleccionamos los índices espectrales obtendremos la siguiente lista</p>
<div class="cell">
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-09d422b4a0794df36490" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-09d422b4a0794df36490">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231"],["vegetation","vegetation","water","vegetation","vegetation","vegetation","vegetation","vegetation","water","water","burn","burn","burn","vegetation","soil","soil","soil","urban","vegetation","urban","vegetation","soil","vegetation","vegetation","vegetation","burn","burn","vegetation","urban","soil","radar","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","radar","radar","urban","soil","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","urban","vegetation","vegetation","vegetation","water","soil","water","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","burn","water","water","vegetation","water","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","water","urban","soil","soil","burn","burn","burn","burn","burn","burn","burn","snow","urban","vegetation","urban","soil","water","vegetation","vegetation","snow","vegetation","urban","urban","urban","urban","urban","vegetation","vegetation","radar","water","vegetation","snow","snow","soil","snow","burn","snow","soil","water","vegetation","vegetation","water","burn","water","water","vegetation","vegetation","urban","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","soil","soil","soil","soil","burn","burn","water","vegetation","vegetation","vegetation","vegetation","vegetation","urban","vegetation","radar","vegetation","vegetation","vegetation","vegetation","radar","vegetation","vegetation","vegetation","soil","vegetation","vegetation","water","snow","vegetation","vegetation","vegetation","burn","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","snow","water","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","vegetation","water","vegetation","urban","vegetation","vegetation","radar","radar","radar","radar","burn","vegetation","urban","vegetation","radar","radar","radar","urban","urban","vegetation","vegetation","water","water","water","water","kernel","kernel","kernel","kernel","kernel","vegetation","vegetation"],["AFRI1600","AFRI2100","ANDWI","ARI","ARI2","ARVI","ATSAVI","AVI","AWEInsh","AWEIsh","BAI","BAIM","BAIS2","BCC","BI","BITM","BIXS","BLFEI","BNDVI","BRBA","BWDRVI","BaI","CCI","CIG","CIRE","CSI","CSIT","CVI","DBI","DBSI","DPDD","DSI","DSWI1","DSWI2","DSWI3","DSWI4","DSWI5","DVI","DVIplus","DpRVIHH","DpRVIVV","EBBI","EMBI","EVI","EVI2","ExG","ExGR","ExR","FCVI","GARI","GBNDVI","GCC","GDVI","GEMI","GLI","GM1","GM2","GNDVI","GOSAVI","GRNDVI","GRVI","GSAVI","GVMI","IAVI","IBI","IKAW","IPVI","IRECI","LSWI","MBI","MBWI","MCARI","MCARI1","MCARI2","MCARI705","MCARIOSAVI","MCARIOSAVI705","MGRVI","MIRBI","MLSWI26","MLSWI27","MNDVI","MNDWI","MNLI","MRBVI","MSAVI","MSI","MSR","MSR705","MTCI","MTVI1","MTVI2","MuWIR","NBAI","NBLI","NBLIOLI","NBR","NBR2","NBRSWIR","NBRT1","NBRT2","NBRT3","NBRplus","NBSIMS","NBUI","ND705","NDBI","NDBaI","NDCI","NDDI","NDGI","NDGlaI","NDII","NDISIb","NDISIg","NDISImndwi","NDISIndwi","NDISIr","NDMI","NDPI","NDPolI","NDPonI","NDREI","NDSI","NDSII","NDSIWV","NDSInw","NDSWIR","NDSaII","NDSoiI","NDTI","NDVI","NDVI705","NDVIMNDWI","NDVIT","NDWI","NDWIns","NDYI","NGRDI","NHFD","NIRv","NIRvH2","NIRvP","NLI","NMDI","NRFIg","NRFIr","NSDS","NSDSI1","NSDSI2","NSDSI3","NSTv1","NSTv2","NWI","NormG","NormNIR","NormR","OCVI","OSAVI","PISI","PSRI","QpRVI","RCC","RDVI","REDSI","RENDVI","RFDI","RGBVI","RGRI","RI","RI4XS","RVI","S2REP","S2WI","S3","SARVI","SAVI","SAVI2","SAVIT","SEVI","SI","SIPI","SR","SR2","SR3","SR555","SR705","SWI","SWM","SeLI","TCARI","TCARIOSAVI","TCARIOSAVI705","TCI","TDVI","TGI","TRRVI","TSAVI","TTVI","TVI","TWI","TriVI","UI","VARI","VARI700","VDDPI","VHVVD","VHVVP","VHVVR","VI6T","VI700","VIBI","VIG","VVVHD","VVVHR","VVVHS","VgNIRBI","VrNIRBI","WDRVI","WDVI","WI1","WI2","WI2015","WRI","kEVI","kIPVI","kNDVI","kRVI","kVARI","mND705","mSR705"],["Aerosol Free Vegetation Index (1600 nm)","Aerosol Free Vegetation Index (2100 nm)","Augmented Normalized Difference Water Index","Anthocyanin Reflectance Index","Anthocyanin Reflectance Index 2","Atmospherically Resistant Vegetation Index","Adjusted Transformed Soil-Adjusted Vegetation Index","Advanced Vegetation Index","Automated Water Extraction Index","Automated Water Extraction Index with Shadows Elimination","Burned Area Index","Burned Area Index adapted to MODIS","Burned Area Index for Sentinel 2","Blue Chromatic Coordinate","Bare Soil Index","Landsat TM-based Brightness Index","SPOT HRV XS-based Brightness Index","Built-Up Land Features Extraction Index","Blue Normalized Difference Vegetation Index","Band Ratio for Built-up Area","Blue Wide Dynamic Range Vegetation Index","Bareness Index","Chlorophyll Carotenoid Index","Chlorophyll Index Green","Chlorophyll Index Red Edge","Char Soil Index","Char Soil Index Thermal","Chlorophyll Vegetation Index","Dry Built-Up Index","Dry Bareness Index","Dual-Pol Diagonal Distance","Drought Stress Index","Disease-Water Stress Index 1","Disease-Water Stress Index 2","Disease-Water Stress Index 3","Disease-Water Stress Index 4","Disease-Water Stress Index 5","Difference Vegetation Index","Difference Vegetation Index Plus","Dual-Polarized Radar Vegetation Index HH","Dual-Polarized Radar Vegetation Index VV","Enhanced Built-Up and Bareness Index","Enhanced Modified Bare Soil Index","Enhanced Vegetation Index","Two-Band Enhanced Vegetation Index","Excess Green Index","ExG - ExR Vegetation Index","Excess Red Index","Fluorescence Correction Vegetation Index","Green Atmospherically Resistant Vegetation Index","Green-Blue Normalized Difference Vegetation Index","Green Chromatic Coordinate","Generalized Difference Vegetation Index","Global Environment Monitoring Index","Green Leaf Index","Gitelson and Merzlyak Index 1","Gitelson and Merzlyak Index 2","Green Normalized Difference Vegetation Index","Green Optimized Soil Adjusted Vegetation Index","Green-Red Normalized Difference Vegetation Index","Green Ratio Vegetation Index","Green Soil Adjusted Vegetation Index","Global Vegetation Moisture Index","New Atmospherically Resistant Vegetation Index","Index-Based Built-Up Index","Kawashima Index","Infrared Percentage Vegetation Index","Inverted Red-Edge Chlorophyll Index","Land Surface Water Index","Modified Bare Soil Index","Multi-Band Water Index","Modified Chlorophyll Absorption in Reflectance Index","Modified Chlorophyll Absorption in Reflectance Index 1","Modified Chlorophyll Absorption in Reflectance Index 2","Modified Chlorophyll Absorption in Reflectance Index (705 and 750 nm)","MCARI/OSAVI Ratio","MCARI/OSAVI Ratio (705 and 750 nm)","Modified Green Red Vegetation Index","Mid-Infrared Burn Index","Modified Land Surface Water Index (MODIS Bands 2 and 6)","Modified Land Surface Water Index (MODIS Bands 2 and 7)","Modified Normalized Difference Vegetation Index","Modified Normalized Difference Water Index","Modified Non-Linear Vegetation Index","Modified Red Blue Vegetation Index","Modified Soil-Adjusted Vegetation Index","Moisture Stress Index","Modified Simple Ratio","Modified Simple Ratio (705 and 750 nm)","MERIS Terrestrial Chlorophyll Index","Modified Triangular Vegetation Index 1","Modified Triangular Vegetation Index 2","Revised Multi-Spectral Water Index","Normalized Built-up Area Index","Normalized Difference Bare Land Index","Normalized Difference Bare Land Index for Landsat-OLI","Normalized Burn Ratio","Normalized Burn Ratio 2","Normalized Burn Ratio SWIR","Normalized Burn Ratio Thermal 1","Normalized Burn Ratio Thermal 2","Normalized Burn Ratio Thermal 3","Normalized Burn Ratio Plus","Non-Binary Snow Index for Multi-Component Surfaces","New Built-Up Index","Normalized Difference (705 and 750 nm)","Normalized Difference Built-Up Index","Normalized Difference Bareness Index","Normalized Difference Chlorophyll Index","Normalized Difference Drought Index","Normalized Difference Greenness Index","Normalized Difference Glacier Index","Normalized Difference Infrared Index","Normalized Difference Impervious Surface Index Blue","Normalized Difference Impervious Surface Index Green","Normalized Difference Impervious Surface Index with MNDWI","Normalized Difference Impervious Surface Index with NDWI","Normalized Difference Impervious Surface Index Red","Normalized Difference Moisture Index","Normalized Difference Phenology Index","Normalized Difference Polarization Index","Normalized Difference Pond Index","Normalized Difference Red Edge Index","Normalized Difference Snow Index","Normalized Difference Snow Ice Index","WorldView Normalized Difference Soil Index","Normalized Difference Snow Index with no Water","Normalized Difference SWIR","Normalized Difference Snow and Ice Index","Normalized Difference Soil Index","Normalized Difference Turbidity Index","Normalized Difference Vegetation Index","Normalized Difference Vegetation Index (705 and 750 nm)","NDVI-MNDWI Model","Normalized Difference Vegetation Index Thermal","Normalized Difference Water Index","Normalized Difference Water Index with no Snow Cover and Glaciers","Normalized Difference Yellowness Index","Normalized Green Red Difference Index","Non-Homogeneous Feature Difference","Near-Infrared Reflectance of Vegetation","Hyperspectral Near-Infrared Reflectance of Vegetation","Near-Infrared Reflectance of Vegetation and Incoming PAR","Non-Linear Vegetation Index","Normalized Multi-band Drought Index","Normalized Rapeseed Flowering Index Green","Normalized Rapeseed Flowering Index Red","Normalized Shortwave Infrared Difference Soil-Moisture","Normalized Shortwave-Infrared Difference Bare Soil Moisture Index 1","Normalized Shortwave-Infrared Difference Bare Soil Moisture Index 2","Normalized Shortwave-Infrared Difference Bare Soil Moisture Index 3","NIR-SWIR-Temperature Version 1","NIR-SWIR-Temperature Version 2","New Water Index","Normalized Green","Normalized NIR","Normalized Red","Optimized Chlorophyll Vegetation Index","Optimized Soil-Adjusted Vegetation Index","Perpendicular Impervious Surface Index","Plant Senescing Reflectance Index","Quad-Polarized Radar Vegetation Index","Red Chromatic Coordinate","Renormalized Difference Vegetation Index","Red-Edge Disease Stress Index","Red Edge Normalized Difference Vegetation Index","Radar Forest Degradation Index","Red Green Blue Vegetation Index","Red-Green Ratio Index","Redness Index","SPOT HRV XS-based Redness Index 4","Ratio Vegetation Index","Sentinel-2 Red-Edge Position","Sentinel-2 Water Index","S3 Snow Index","Soil Adjusted and Atmospherically Resistant Vegetation Index","Soil-Adjusted Vegetation Index","Soil-Adjusted Vegetation Index 2","Soil-Adjusted Vegetation Index Thermal","Shadow-Eliminated Vegetation Index","Shadow Index","Structure Insensitive Pigment Index","Simple Ratio","Simple Ratio (800 and 550 nm)","Simple Ratio (860, 550 and 708 nm)","Simple Ratio (555 and 750 nm)","Simple Ratio (705 and 750 nm)","Snow Water Index","Sentinel Water Mask","Sentinel-2 LAI Green Index","Transformed Chlorophyll Absorption in Reflectance Index","TCARI/OSAVI Ratio","TCARI/OSAVI Ratio (705 and 750 nm)","Triangular Chlorophyll Index","Transformed Difference Vegetation Index","Triangular Greenness Index","Transformed Red Range Vegetation Index","Transformed Soil-Adjusted Vegetation Index","Transformed Triangular Vegetation Index","Transformed Vegetation Index","Triangle Water Index","Triangular Vegetation Index","Urban Index","Visible Atmospherically Resistant Index","Visible Atmospherically Resistant Index (700 nm)","Vertical Dual De-Polarization Index","VH-VV Difference","VH-VV Product","VH-VV Ratio","VI6T Index","Vegetation Index (700 nm)","Vegetation Index Built-up Index","Vegetation Index Green","VV-VH Difference","VV-VH Ratio","VV-VH Sum","Visible Green-Based Built-Up Index","Visible Red-Based Built-Up Index","Wide Dynamic Range Vegetation Index","Weighted Difference Vegetation Index","Water Index 1","Water Index 2","Water Index 2015","Water Ratio Index","Kernel Enhanced Vegetation Index","Kernel Infrared Percentage Vegetation Index","Kernel Normalized Difference Vegetation Index","Kernel Ratio Vegetation Index","Kernel Visible Atmospherically Resistant Index","Modified Normalized Difference (705, 750 and 445 nm)","Modified Simple Ratio (705 and 445 nm)"],["(N - 0.66 * S1) / (N + 0.66 * S1)","(N - 0.5 * S2) / (N + 0.5 * S2)","(B + G + R - N - S1 - S2)/(B + G + R + N + S1 + S2)","(1 / G) - (1 / RE1)","N * ((1 / G) - (1 / RE1))","(N - (R - gamma * (R - B))) / (N + (R - gamma * (R - B)))","sla * (N - sla * R - slb) / (sla * N + R - sla * slb + 0.08 * (1 + sla ** 2.0))","(N * (1.0 - R) * (N - R)) ** (1/3)","4.0 * (G - S1) - 0.25 * N + 2.75 * S2","B + 2.5 * G - 1.5 * (N + S1) - 0.25 * S2","1.0 / ((0.1 - R) ** 2.0 + (0.06 - N) ** 2.0)","1.0/((0.05 - N) ** 2.0) + ((0.2 - S2) ** 2.0)","(1.0 - ((RE2 * RE3 * N2) / R) ** 0.5) * (((S2 - N2)/(S2 + N2) ** 0.5) + 1.0)","B / (R + G + B)","((S1 + R) - (N + B))/((S1 + R) + (N + B))","(((B**2.0)+(G**2.0)+(R**2.0))/3.0)**0.5","(((G**2.0)+(R**2.0))/2.0)**0.5","(((G+R+S2)/3.0)-S1)/(((G+R+S2)/3.0)+S1)","(N - B)/(N + B)","R/S1","(alpha * N - B) / (alpha * N + B)","R + S1 - N","(G1 - R)/(G1 + R)","(N / G) - 1.0","(N / RE1) - 1","N/S2","N / (S2 * T / 10000.0)","(N * R) / (G ** 2.0)","((B - T1)/(B + T1)) - ((N - R)/(N + R))","((S1 - G)/(S1 + G)) - ((N - R)/(N + R))","(VV + VH)/2.0 ** 0.5","S1/N","N/S1","S1/G","S1/R","G/R","(N + G)/(S1 + R)","N - R","((lambdaN - lambdaR)/(lambdaN - lambdaG)) * G + (1.0 - ((lambdaN - lambdaR)/(lambdaN - lambdaG))) * N - R","(4.0 * HV)/(HH + HV)","(4.0 * VH)/(VV + VH)","(S1 - N) / (10.0 * ((S1 + T) ** 0.5))","((((S1 - S2 - N)/(S1 + S2 + N)) + 0.5) - ((G - S1)/(G + S1)) - 0.5)/((((S1 - S2 - N)/(S1 + S2 + N)) + 0.5) + ((G - S1)/(G + S1)) + 1.5)","g * (N - R) / (N + C1 * R - C2 * B + L)","g * (N - R) / (N + 2.4 * R + L)","2 * G - R - B","(2.0 * G - R - B) - (1.3 * R - G)","1.3 * R - G","N - ((R + G + B)/3.0)","(N - (G - (B - R))) / (N - (G + (B - R)))","(N - (G + B))/(N + (G + B))","G / (R + G + B)","((N ** nexp) - (R ** nexp)) / ((N ** nexp) + (R ** nexp))","((2.0*((N ** 2.0)-(R ** 2.0)) + 1.5*N + 0.5*R)/(N + R + 0.5))*(1.0 - 0.25*((2.0 * ((N ** 2.0) - (R ** 2)) + 1.5 * N + 0.5 * R)/(N + R + 0.5)))-((R - 0.125)/(1 - R))","(2.0 * G - R - B) / (2.0 * G + R + B)","RE2/G","RE2/RE1","(N - G)/(N + G)","(N - G) / (N + G + 0.16)","(N - (G + R))/(N + (G + R))","N/G","(1.0 + L) * (N - G) / (N + G + L)","((N + 0.1) - (S2 + 0.02)) / ((N + 0.1) + (S2 + 0.02))","(N - (R - gamma * (B - R)))/(N + (R - gamma * (B - R)))","(((S1-N)/(S1+N))-(((N-R)*(1.0+L)/(N+R+L))+((G-S1)/(G+S1)))/2.0)/(((S1-N)/(S1+N))+(((N-R)*(1.0+L)/(N+R+L))+((G-S1)/(G+S1)))/2.0)","(R - B)/(R + B)","N/(N + R)","(RE3 - R) / (RE1 / RE2)","(N - S1)/(N + S1)","((S1 - S2 - N)/(S1 + S2 + N)) + 0.5","(omega * G) - R - N - S1 - S2","((RE1 - R) - 0.2 * (RE1 - G)) * (RE1 / R)","1.2 * (2.5 * (N - R) - 1.3 * (N - G))","(1.5 * (2.5 * (N - R) - 1.3 * (N - G))) / ((((2.0 * N + 1) ** 2) - (6.0 * N - 5 * (R ** 0.5)) - 0.5) ** 0.5)","((RE2 - RE1) - 0.2 * (RE2 - G)) * (RE2 / RE1)","(((RE1 - R) - 0.2 * (RE1 - G)) * (RE1 / R)) / (1.16 * (N - R) / (N + R + 0.16))","(((RE2 - RE1) - 0.2 * (RE2 - G)) * (RE2 / RE1)) / (1.16 * (RE2 - RE1) / (RE2 + RE1 + 0.16))","(G ** 2.0 - R ** 2.0) / (G ** 2.0 + R ** 2.0)","10.0 * S2 - 9.8 * S1 + 2.0","(1.0 - N - S1)/(1.0 - N + S1)","(1.0 - N - S2)/(1.0 - N + S2)","(N - S2)/(N + S2)","(G - S1) / (G + S1)","(1 + L)*((N ** 2) - R)/((N ** 2) + R + L)","(R ** 2.0 - B ** 2.0)/(R ** 2.0 + B ** 2.0)","0.5 * (2.0 * N + 1 - (((2 * N + 1) ** 2) - 8 * (N - R)) ** 0.5)","S1/N","(N / R - 1) / ((N / R + 1) ** 0.5)","(RE2 / RE1 - 1) / ((RE2 / RE1 + 1) ** 0.5)","(RE2 - RE1) / (RE1 - R)","1.2 * (1.2 * (N - G) - 2.5 * (R - G))","(1.5 * (1.2 * (N - G) - 2.5 * (R - G))) / ((((2.0 * N + 1) ** 2) - (6.0 * N - 5 * (R ** 0.5)) - 0.5) ** 0.5)","-4.0 * ((B - G)/(B + G)) + 2.0 * ((G - N)/(G + N)) + 2.0 * ((G - S2)/(G + S2)) - ((G - S1)/(G + S1))","((S2 - S1)/G)/((S2 + S1)/G)","(R - T)/(R + T)","(R - T1)/(R + T1)","(N - S2) / (N + S2)","(S1 - S2) / (S1 + S2)","(S2 - S1 - 0.02)/(S2 + S1 + 0.1)","(N - (S2 * T / 10000.0)) / (N + (S2 * T / 10000.0))","((N / (T / 10000.0)) - S2) / ((N / (T / 10000.0)) + S2)","((N - (T / 10000.0)) - S2) / ((N - (T / 10000.0)) + S2)","(S2 - N2 - G - B)/(S2 + N2 + G + B)","0.36 * (G + R + N) - (((B + S2)/G) + S1)","((S1 - N)/(10.0 * (T + S1) ** 0.5)) - (((N - R) * (1.0 + L))/(N - R + L)) - (G - S1)/(G + S1)","(RE2 - RE1)/(RE2 + RE1)","(S1 - N) / (S1 + N)","(S1 - T) / (S1 + T)","(RE1 - R)/(RE1 + R)","(((N - R)/(N + R)) - ((G - N)/(G + N)))/(((N - R)/(N + R)) + ((G - N)/(G + N)))","(((lambdaN - lambdaR)/(lambdaN - lambdaG)) * G + (1.0 - ((lambdaN - lambdaR)/(lambdaN - lambdaG))) * N - R)/(((lambdaN - lambdaR)/(lambdaN - lambdaG)) * G + (1.0 - ((lambdaN - lambdaR)/(lambdaN - lambdaG))) * N + R)","(G - R)/(G + R)","(N - S1)/(N + S1)","(T - (B + N + S1) / 3.0)/(T + (B + N + S1) / 3.0)","(T - (G + N + S1) / 3.0)/(T + (G + N + S1) / 3.0)","(T - (((G - S1)/(G + S1)) + N + S1) / 3.0)/(T + (((G - S1)/(G + S1)) + N + S1) / 3.0)","(T - (((G - N)/(G + N)) + N + S1) / 3.0)/(T + (((G - N)/(G + N)) + N + S1) / 3.0)","(T - (R + N + S1) / 3.0)/(T + (R + N + S1) / 3.0)","(N - S1)/(N + S1)","(N - (alpha * R + (1.0 - alpha) * S1))/(N + (alpha * R + (1.0 - alpha) * S1))","(VV - VH)/(VV + VH)","(S1-G)/(S1+G)","(N - RE1) / (N + RE1)","(G - S1) / (G + S1)","(G - N)/(G + N)","(G - Y)/(G + Y)","(N - S1 - beta)/(N + S1)","(N - S1)/(N + S1)","(R - S1) / (R + S1)","(S2 - G)/(S2 + G)","(R-G)/(R+G)","(N - R)/(N + R)","(RE2 - RE1) / (RE2 + RE1)","((N - R)/(N + R)) - ((G - S1)/(G + S1))","(N - (R * T / 10000.0))/(N + (R * T / 10000.0))","(G - N) / (G + N)","(G - alpha * N)/(G + N)","(G - B) / (G + B)","(G - R) / (G + R)","(RE1 - A) / (RE1 + A)","((N - R) / (N + R)) * N","N - R - k * (lambdaN - lambdaR)","((N - R) / (N + R)) * N * PAR","((N ** 2) - R)/((N ** 2) + R)","(N - (S1 - S2))/(N + (S1 - S2))","(G - S2) / (G + S2)","(R - S2) / (R + S2)","(S1 - S2)/(S1 + S2)","(S1-S2)/S1","(S1-S2)/S2","(S1-S2)/(S1+S2)","((N-S2)/(N+S2))*T","(N-(S2+T))/(N+(S2+T))","(B - (N + S1 + S2))/(B + (N + S1 + S2))","G/(N + G + R)","N/(N + G + R)","R/(N + G + R)","(N / G) * (R / G) ** cexp","(N - R) / (N + R + 0.16)","0.8192 * B - 0.5735 * N + 0.0750","(R - B)/RE2","(8.0 * HV)/(HH + VV + 2.0 * HV)","R / (R + G + B)","(N - R) / ((N + R) ** 0.5)","((705.0 - 665.0) * (RE3 - R) - (783.0 - 665.0) * (RE1 - R)) / (2.0 * R)","(RE2 - RE1)/(RE2 + RE1)","(HH - HV)/(HH + HV)","(G ** 2.0 - B * R)/(G ** 2.0 + B * R)","R/G","(R - G)/(R + G)","(R**2.0)/(G**4.0)","RE2 / R","705.0 + 35.0 * ((((RE3 + R) / 2.0) - RE1) / (RE2 - RE1))","(RE1 - S2)/(RE1 + S2)","(N * (R - S1)) / ((N + R) * (N + S1))","(1 + L)*(N - (R - (R - B))) / (N + (R - (R - B)) + L)","(1.0 + L) * (N - R) / (N + R + L)","N / (R + (slb / sla))","(1.0 + L) * (N - (R * T / 10000.0)) / (N + (R * T / 10000.0) + L)","(N/R) + fdelta * (1.0/R)","((1.0 - B) * (1.0 - G) * (1.0 - R)) ** (1/3)","(N - A) / (N - R)","N/R","N/G","N2/(G * RE1)","RE2 / G","RE2 / RE1","(G * (N - S1)) / ((G + N) * (N + S1))","(B + G)/(N + S1)","(N2 - RE1) / (N2 + RE1)","3 * ((RE1 - R) - 0.2 * (RE1 - G) * (RE1 / R))","(3 * ((RE1 - R) - 0.2 * (RE1 - G) * (RE1 / R))) / (1.16 * (N - R) / (N + R + 0.16))","(3 * ((RE2 - RE1) - 0.2 * (RE2 - G) * (RE2 / RE1))) / (1.16 * (RE2 - RE1) / (RE2 + RE1 + 0.16))","1.2 * (RE1 - G) - 1.5 * (R - G) * (RE1 / R) ** 0.5","1.5 * ((N - R)/((N ** 2.0 + R + 0.5) ** 0.5))","- 0.5 * (190 * (R - G) - 120 * (R - B))","((RE2 - R) / (RE2 + R)) / (((N - R) / (N + R)) + 1.0)","sla * (N - sla * R - slb) / (sla * N + R - sla * slb)","0.5 * ((865.0 - 740.0) * (RE3 - RE2) - (N2 - RE2) * (783.0 - 740))","(((N - R)/(N + R)) + 0.5) ** 0.5","(2.84 * (RE1 - RE2) / (G + S2)) + ((1.25 * (G - B) - (N - B)) / (N + 1.25 * G - 0.25 * B))","0.5 * (120 * (N - G) - 200 * (R - G))","(S2 - N)/(S2 + N)","(G - R) / (G + R - B)","(RE1 - 1.7 * R + 0.7 * B) / (RE1 + 1.3 * R - 1.3 * B)","(VV + VH)/VV","VH - VV","VH * VV","VH/VV","(N - T/10000.0)/(N + T/10000.0)","(RE1 - R) / (RE1 + R)","((N-R)/(N+R))/(((N-R)/(N+R)) + ((S1-N)/(S1+N)))","(G - R) / (G + R)","VV - VH","VV/VH","VV + VH","(G - N)/(G + N)","(R - N)/(R + N)","(alpha * N - R) / (alpha * N + R)","N - sla * R","(G - S2) / (G + S2)","(B - S2) / (B + S2)","1.7204 + 171 * G + 3 * R - 70 * N - 45 * S1 - 71 * S2","(G + R)/(N + S1)","g * (kNN - kNR) / (kNN + C1 * kNR - C2 * kNB + kNL)","kNN/(kNN + kNR)","(kNN - kNR)/(kNN + kNR)","kNN / kNR","(kGG - kGR) / (kGG + kGR - kGB)","(RE2 - RE1)/(RE2 + RE1 - A)","(RE2 - A)/(RE2 + A)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Dominio<\/th>\n      <th>Sigla<\/th>\n      <th>Nombre<\/th>\n      <th>Formula<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br></p>
<p>Seleccionares índices espectrales urbanos (<a href="https://dergipark.org.tr/en/download/article-file/2810383">comparaciones de indices urbanos</a>) y escogeremos el <a href="https://www.tandfonline.com/doi/abs/10.1080/01431160304987">NDBI</a> (Normalized Difference Built-Up Index).</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="imagenes/ndbi.png" class="img-fluid figure-img" width="600"></p>
<p></p><figcaption class="figure-caption margin-caption">NDBI Normalized Difference Built-Up Index</figcaption><p></p>
</figure>
</div>
<section id="selección-de-área-de-estudio" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="selección-de-área-de-estudio"><span class="header-section-number">7.3.1</span> Selección de Área de Estudio</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mi_comuna <span class="ot">&lt;-</span>  <span class="st">"LAS CONDES"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>roi <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">"data/rds/zonas_urb_consolidadas.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( NOM_COMUNA <span class="sc">==</span> mi_comuna) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4326</span>) </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roi<span class="sc">$</span>geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="indices_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>roi_ee <span class="ot">&lt;-</span>  roi<span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_union</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sf_as_ee</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-psat" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="sec-psat"><span class="header-section-number">7.3.2</span> Selección Imagen Satelital</h3>
<p>Para el siguiente análisis usaremos el un producto satelital de <a href="https://developers.google.com/earth-engine/datasets/catalog/sentinel">Sentinel Collections</a>, denominado <a href="https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S2_HARMONIZED#bands">Harmonized Sentinel-2 MSI: MultiSpectral Instrument, Level-1C</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>maskS2clouds <span class="ot">&lt;-</span> <span class="cf">function</span>(image) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  qa <span class="ot">&lt;-</span> image<span class="sc">$</span><span class="fu">select</span>(<span class="st">"QA60"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bits 10 and 11 are clouds and cirrus, respectively.</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  cloudBitMask <span class="ot">&lt;-</span> <span class="fu">bitwShiftL</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  cirrusBitMask <span class="ot">&lt;-</span> <span class="fu">bitwShiftL</span>(<span class="dv">1</span>, <span class="dv">11</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Both flags should be set to zero, indicating clear conditions.</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  mask <span class="ot">&lt;-</span> qa<span class="sc">$</span><span class="fu">bitwiseAnd</span>(cloudBitMask)<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">0</span>)<span class="sc">$</span><span class="fu">And</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    qa<span class="sc">$</span><span class="fu">bitwiseAnd</span>(cirrusBitMask)<span class="sc">$</span><span class="fu">eq</span>(<span class="dv">0</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the masked and scaled data, without the QA bands.</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  image<span class="sc">$</span><span class="fu">updateMask</span>(mask)<span class="sc">$</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">divide</span>(<span class="dv">10000</span>)<span class="sc">$</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">"B.*"</span>)<span class="sc">$</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copyProperties</span>(image, <span class="fu">list</span>(<span class="st">"system:time_start"</span>))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the function over one year of data and take the median.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Sentinel-2 TOA reflectance data.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>S2 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">ImageCollection</span>(<span class="st">"COPERNICUS/S2_HARMONIZED"</span>)<span class="sc">$</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterDate</span>(<span class="st">"2016-01-01"</span>, <span class="st">"2016-12-31"</span>)<span class="sc">$</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ee<span class="sc">$</span>Filter<span class="sc">$</span><span class="fu">lt</span>(<span class="st">"CLOUDY_PIXEL_PERCENTAGE"</span>, <span class="dv">20</span>))<span class="sc">$</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(maskS2clouds)<span class="sc">$</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>()<span class="sc">$</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clip</span>(roi_ee)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>viz <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">bands =</span> <span class="fu">c</span>(<span class="st">"B4"</span>, <span class="st">"B3"</span>, <span class="st">"B2"</span>), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.3</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">centerObject</span>(<span class="at">eeObject =</span> S2,<span class="at">zoom =</span> <span class="dv">12</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(S2, viz, <span class="st">"RGB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-findex" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="sec-findex"><span class="header-section-number">7.3.3</span> Aplicar Índice</h3>
<p>la función NDBI corresponde a la siguiente:</p>
<p><span class="math display">NDBI = \frac{S1-N}{S1+N}</span> Por lo anterior es muy importante conocer los nombres de la bandas para crear correctamente la función, a continuación de exponen las bandas del producto satelital Sentinel. Buscar información de productos satelitales en <a href="https://developers.google.com/earth-engine/datasets">Earth Engine Data Catalog</a> de donde se obtuvo la siguiente <a href="#tbl-bandsS2">Table&nbsp;<span>7.1</span></a> para el caso de Sentinel 2.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-bandsS2" class="anchored">

<table class="table table-striped table-hover table-condensed" style="font-size: 16px; margin-left: auto; margin-right: auto;"><caption>Table&nbsp;7.1:  Bandas de Sentinel 2 </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Name </th>
   <th style="text-align:left;"> Pixel.Size </th>
   <th style="text-align:left;"> Wavelength </th>
   <th style="text-align:left;"> Description </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> B1 </td>
   <td style="text-align:left;"> 60 meters </td>
   <td style="text-align:left;"> 443.9nm (S2A) / 442.3nm (S2B) </td>
   <td style="text-align:left;"> Aerosols </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B2 </td>
   <td style="text-align:left;"> 10 meters </td>
   <td style="text-align:left;"> 496.6nm (S2A) / 492.1nm (S2B) </td>
   <td style="text-align:left;"> Blue </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B3 </td>
   <td style="text-align:left;"> 10 meters </td>
   <td style="text-align:left;"> 560nm (S2A) / 559nm (S2B) </td>
   <td style="text-align:left;"> Green </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B4 </td>
   <td style="text-align:left;"> 10 meters </td>
   <td style="text-align:left;"> 664.5nm (S2A) / 665nm (S2B) </td>
   <td style="text-align:left;"> Red </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B5 </td>
   <td style="text-align:left;"> 20 meters </td>
   <td style="text-align:left;"> 703.9nm (S2A) / 703.8nm (S2B) </td>
   <td style="text-align:left;"> Red Edge 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B6 </td>
   <td style="text-align:left;"> 20 meters </td>
   <td style="text-align:left;"> 740.2nm (S2A) / 739.1nm (S2B) </td>
   <td style="text-align:left;"> Red Edge 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B7 </td>
   <td style="text-align:left;"> 20 meters </td>
   <td style="text-align:left;"> 782.5nm (S2A) / 779.7nm (S2B) </td>
   <td style="text-align:left;"> Red Edge 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B8 </td>
   <td style="text-align:left;"> 10 meters </td>
   <td style="text-align:left;"> 835.1nm (S2A) / 833nm (S2B) </td>
   <td style="text-align:left;"> NIR </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B8A </td>
   <td style="text-align:left;"> 20 meters </td>
   <td style="text-align:left;"> 864.8nm (S2A) / 864nm (S2B) </td>
   <td style="text-align:left;"> Red Edge 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B9 </td>
   <td style="text-align:left;"> 60 meters </td>
   <td style="text-align:left;"> 945nm (S2A) / 943.2nm (S2B) </td>
   <td style="text-align:left;"> Water vapor </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B11 </td>
   <td style="text-align:left;"> 20 meters </td>
   <td style="text-align:left;"> 1613.7nm (S2A) / 1610.4nm (S2B) </td>
   <td style="text-align:left;"> SWIR 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B12 </td>
   <td style="text-align:left;"> 20 meters </td>
   <td style="text-align:left;"> 2202.4nm (S2A) / 2185.7nm (S2B) </td>
   <td style="text-align:left;"> SWIR 2 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>F_NDBI<span class="ot">&lt;-</span> <span class="cf">function</span> (image){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  ndbi<span class="ot">&lt;-</span>image<span class="sc">$</span><span class="fu">expression</span>(<span class="st">'float(S1-N)/float(S1+N)'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">opt_map=</span><span class="fu">list</span>(<span class="st">"N"</span><span class="ot">=</span>image<span class="sc">$</span><span class="fu">select</span>(<span class="st">"B8"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"S1"</span><span class="ot">=</span>image<span class="sc">$</span><span class="fu">select</span>(<span class="st">"B11"</span>)))<span class="sc">$</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">"NDBI"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ndbi)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>S2_NDBI <span class="ot">&lt;-</span> <span class="fu">F_NDBI</span>(S2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizar-resultados" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="visualizar-resultados"><span class="header-section-number">7.3.4</span> Visualizar Resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pal_ndbi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'white'</span> , <span class="st">'white'</span>, <span class="st">'white'</span>, <span class="st">'red'</span> , <span class="st">'red'</span>, <span class="st">'red'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>viz_ndbi<span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">max=</span><span class="dv">1</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">palette=</span>pal_ndbi)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">centerObject</span>(<span class="at">eeObject =</span> roi_ee,<span class="at">zoom =</span> <span class="dv">12</span>) </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(S2_NDBI,<span class="at">visParams =</span>viz_ndbi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calcular-un-índice" class="level3" data-number="7.3.5">
<h3 data-number="7.3.5" class="anchored" data-anchor-id="calcular-un-índice"><span class="header-section-number">7.3.5</span> Calcular un índice</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mz_sii <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/rds/mz_constru_SII.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_com <span class="sc">==</span> mi_comuna) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(roi) <span class="sc">%&gt;%</span> <span class="co"># seleccionar solo mazanas urbanas</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Extraer los valores con la función <code>ee_extract</code> cuya documentación se encuentra en el siguiente <a href="https://r-spatial.github.io/rgee/reference/ee_extract.html">link</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract values - getInfo</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ee_com_urb <span class="ot">&lt;-</span> <span class="fu">ee_extract</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a> <span class="at">x =</span> S2_NDBI,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a> <span class="at">y =</span> mz_sii[<span class="st">"id"</span>],</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a> <span class="at">scale =</span> <span class="dv">10</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a> <span class="at">fun =</span> ee<span class="sc">$</span>Reducer<span class="sc">$</span><span class="fu">mean</span>(),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a> <span class="at">sf =</span> <span class="cn">TRUE</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mz_sii_urb <span class="ot">&lt;-</span> mz_sii <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ee_com_urb <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>(), <span class="at">by =</span> <span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="corrección" class="level3" data-number="7.3.6">
<h3 data-number="7.3.6" class="anchored" data-anchor-id="corrección"><span class="header-section-number">7.3.6</span> Corrección</h3>
<p>Para eliminar los <em>falsos positivos</em> se propone que todas las manzanas que tengan un total de metros construidos igual a cero el valor de NDBI y sea NA, caso contrario mantiene el valor original.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mz_sii_urb <span class="ot">&lt;-</span> mz_sii_urb <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NDBI =</span> <span class="fu">ifelse</span>(total <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, NDBI))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="histograma-de-ndvi" class="level3 page-columns page-full" data-number="7.3.7">
<h3 data-number="7.3.7" class="anchored" data-anchor-id="histograma-de-ndvi"><span class="header-section-number">7.3.7</span> Histograma de NDVI</h3>
<p>Para conocer la distribución de frecuencia de los valores del Índice se presenta su histograma (<a href="#fig-histo">Figure&nbsp;<span>7.2</span></a>). En caso de creer que se necesita definir un umbral de corte se puede tomar esa decisión observando esta distribución.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mz_sii_urb, <span class="fu">aes</span>(<span class="at">x =</span> NDBI)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#1d91c0"</span>, <span class="at">color =</span><span class="st">"gray80"</span>)<span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histograma de Índice de Urbanismo"</span>, <span class="at">x =</span><span class="st">"NDBI"</span>, <span class="at">y =</span> <span class="st">"Frecuencias"</span>)<span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>,<span class="at">colour=</span> <span class="st">"gray60"</span>, <span class="at">size=</span><span class="dv">10</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-histo" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="indices_files/figure-html/fig-histo-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;7.2: Histograma de valores de NDBI</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-vismap" class="level3 page-columns page-full" data-number="7.3.8">
<h3 data-number="7.3.8" class="anchored" data-anchor-id="sec-vismap"><span class="header-section-number">7.3.8</span> Visualización espacial de NDBI</h3>
<p>Visualización espacial de dinámica de los resultados (book no disponible por memoria)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(mz_sii_urb, <span class="at">zcol=</span> <span class="st">"NDBI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para una visualización estática de las manzanas con el valor del índice se crea siguiente de figura (<a href="#fig-mapNDBI">Figure&nbsp;<span>7.3</span></a>) utilizando la librería <a href="https://ggplot2.tidyverse.org">ggplot2</a> y para paleta de colores llamada <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">viridis</a>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización ggplot y sf</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mz_sii_urb, <span class="fu">aes</span>(<span class="at">fill =</span> NDBI), <span class="at">alpha=</span><span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"E"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Urban Index: NDBI"</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray80"</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray80"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-mapNDBI" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="indices_files/figure-html/fig-mapNDBI-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;7.3: Índice NDBI en la comuna de Las Condes</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-los-resultados" class="level3" data-number="7.3.9">
<h3 data-number="7.3.9" class="anchored" data-anchor-id="guardar-los-resultados"><span class="header-section-number">7.3.9</span> Guardar los resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ee_com_urb, <span class="at">file =</span> <span class="st">"data/rds/ndbi_2016.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="monitoreo-de-sequía-laguna-de-aculeo" class="level2 page-columns page-full" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="monitoreo-de-sequía-laguna-de-aculeo"><span class="header-section-number">7.4</span> Monitoreo de Sequía Laguna de Aculeo</h2>
<p>Para el siguiente análisis utilizaremos el NDWI: Normalized Difference Water Index)</p>
<section id="el-problema" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="el-problema"><span class="header-section-number">7.4.1</span> El Problema</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imagenes/aculeo2.png" class="img-fluid figure-img" width="600"></p>
</figure>
</div>
<p><strong>Noticias Relacionadas:</strong></p>
<p><a href="Laguna de Aculeo, una de las primeras víctimas del cambio climático y megasequía según estudio">“Laguna de Aculeo, una de las primeras víctimas del cambio climático y megasequía según estudio”. Biobiochile.cl 20-JUN-2019</a></p>
<p><a href="https://www.latercera.com/la-tercera-pm/noticia/la-sequia-aculeo-vista-desde-espacio/161215/">“La sequía de Aculeo vista desde el espacio”. Diario La Tercera 11-MAY-2018</a></p>
<p><a href="https://www.greenpeace.org/chile/noticia/uncategorized/en-desaparecida-laguna-de-aculeo-proponen-que-nueva-constitucion-tenga-sello-medioambiental-greenpeace-ilustra-la-grave-emergencia-climatica-en-chile/">“En desaparecida laguna de Aculeo proponen que nueva Constitución tenga sello medioambiental: Greenpeace ilustra la grave emergencia climática en Chile” Greenpeace 28-NOV-2019</a></p>
</section>
<section id="lectura-de-insumo-cuerpos-de-agua-nacional" class="level3 page-columns page-full" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="lectura-de-insumo-cuerpos-de-agua-nacional"><span class="header-section-number">7.4.2</span> Lectura de Insumo Cuerpos de Agua Nacional</h3>
<p>Lectura de los cuerpos de agua a nivel nacional</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>masas_agua <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/shape/masas_agua.shp"</span>, <span class="at">quiet =</span> T)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>masas_agua</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 16644 features and 7 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -5659.382 ymin: 3803587 xmax: 692350 ymax: 8050958
Projected CRS: WGS 84 / UTM zone 19S
First 10 features:
                                    NOMBRE TIPO_MAGUA COMUNA    AREA_KM2 RULEID
1                       Laguna Tebinquiche     Laguna   &lt;NA&gt;  2.08693247      5
2                                     &lt;NA&gt;     Laguna   &lt;NA&gt;  0.84982790      5
3                           Salar de Pujsa      Salar   &lt;NA&gt;  0.22226662      7
4                           Salar de Pujsa      Salar   &lt;NA&gt; 16.64594244      7
5                         Salar de Atacama      Salar   &lt;NA&gt; 49.61221690      7
6                           Salar de Pujsa      Salar   &lt;NA&gt;  0.02636444      7
7            Salar de Loyoques o Quisquiro      Salar   &lt;NA&gt; 65.49493327      7
8            Salar de Loyoques o Quisquiro      Salar   &lt;NA&gt;  0.63644089      7
9                           Salar de Pujsa      Salar   &lt;NA&gt;  0.08644732      7
10 Laguna en Salar de Loyoques o Quisquiro     Laguna   &lt;NA&gt;  0.02395804      5
   SHAPE_Leng  SHAPE_Area                       geometry
1  12353.4677  2086932.47 MULTIPOLYGON (((575205.1 74...
2   4397.5639   849827.90 MULTIPOLYGON (((661560.1 74...
3   3305.8444   222266.62 MULTIPOLYGON (((652931.2 74...
4  26208.2874 16645942.44 MULTIPOLYGON (((652560 7434...
5  44044.4984 49612216.90 MULTIPOLYGON (((569340.4 74...
6    606.6370    26364.45 MULTIPOLYGON (((653547.4 74...
7  67250.4947 65494933.27 MULTIPOLYGON (((672122.6 74...
8   5459.5505   636440.89 MULTIPOLYGON (((671993 7433...
9   1147.0949    86447.32 MULTIPOLYGON (((653825.7 74...
10   686.3645    23958.04 MULTIPOLYGON (((673224.5 74...</code></pre>
</div>
</div>
<p>Filtro por patrón de texto para identificar el cuerpo de agua que necesitamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Buscar nombre del cuerpo de aguar por patrón de texto</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">"Aculeo$"</span>, <span class="at">x =</span> masas_agua<span class="sc">$</span>NOMBRE, <span class="at">value =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Laguna de Aculeo"</code></pre>
</div>
</div>
<p>Filtro por patrón de texto para identificar el cuerpo de agua que necesitamos posteriormente se le remueve en las islas interiores en la laguna.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer Laguna Aculeo</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>lag_aculeo <span class="ot">&lt;-</span> masas_agua<span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NOMBRE <span class="sc">==</span> <span class="st">"Laguna de Aculeo"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  sfheaders<span class="sc">::</span><span class="fu">sf_remove_holes</span>() <span class="do">## remover polígonos internos%&gt;%&gt;%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualización de la laguna Acualeo</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> lag_aculeo, <span class="at">fill =</span> <span class="st">"#1d91c0"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Laguna Aculeo"</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray80"</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray80"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-lagAculeo" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="indices_files/figure-html/fig-lagAculeo-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;7.4: Laguna de Aculeo</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Crear objetos en formato E.Engine para su utilización con la plataforma</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Laguna Formato ee</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>lag_aculeo_ee <span class="ot">&lt;-</span> lag_aculeo<span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_buffer</span>(<span class="dv">500</span>)<span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4326</span>)<span class="sc">%&gt;%</span>  <span class="co">#crs atlon</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sf_as_ee</span>()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># región  para definir región de interés para los mapas</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> lag_aculeo_ee<span class="sc">$</span><span class="fu">geometry</span>()<span class="sc">$</span><span class="fu">bounds</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lectura-de-insumo-satelital-visualización-previa" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="lectura-de-insumo-satelital-visualización-previa"><span class="header-section-number">7.4.3</span> Lectura de insumo satelital visualización previa</h3>
<p>A continuación se procederá a calcular el índice normalizado de Water index para un año en específico en este caso 2018 y visualizar su resultado en un mapa</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>imagen <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">ImageCollection</span>(<span class="st">'LANDSAT/LC08/C01/T1_TOA'</span>)<span class="sc">$</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterBounds</span>(region)<span class="sc">$</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterDate</span>(<span class="st">'2018-01-01'</span>,<span class="st">'2018-12-31'</span>)<span class="sc">$</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterMetadata</span>(<span class="st">'CLOUD_COVER'</span>,<span class="st">'less_than'</span>, <span class="dv">5</span>)<span class="sc">$</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>()<span class="sc">$</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clip</span>(region)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ndwi <span class="ot">&lt;-</span> imagen<span class="sc">$</span><span class="fu">normalizedDifference</span>(<span class="fu">c</span>(<span class="st">"B3"</span>, <span class="st">"B5"</span>))<span class="sc">$</span><span class="fu">clip</span>(region)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ndwiMask <span class="ot">&lt;-</span> ndwi<span class="sc">$</span><span class="fu">updateMask</span>(ndwi<span class="sc">$</span><span class="fu">gte</span>(<span class="dv">0</span>))<span class="co">#greater than or equal to the given value.</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>ndwiViz <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"#00FFFF"</span>,<span class="st">'#0080FF'</span>, <span class="st">"#0000FF"</span>))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>imgViz <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fl">0.5</span>,  <span class="at">bands =</span> <span class="fu">c</span>(<span class="st">"B4"</span>, <span class="st">"B3"</span>, <span class="st">"B2"</span>), <span class="at">gamma =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">1.1</span>, <span class="dv">1</span>))</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">centerObject</span>(region, <span class="at">zoom =</span> <span class="dv">13</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>mapa <span class="ot">&lt;-</span> Map<span class="sc">$</span><span class="fu">addLayer</span>(imagen, imgViz,<span class="st">'RGB'</span>)<span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  Map<span class="sc">$</span><span class="fu">addLayer</span>(ndwiMask, ndwiViz,<span class="st">'NDWI'</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>mapa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d93e73eb68200036a467" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d93e73eb68200036a467">{"x":{"options":{"minZoom":1,"maxZoom":24,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addLayersControl","args":[["CartoDB.Positron","OpenStreetMap","CartoDB.DarkMatter","Esri.WorldImagery","OpenTopoMap"],[],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addTiles","args":["https://earthengine.googleapis.com/v1alpha/projects/earthengine-legacy/maps/f1481a5ded605c5bd789ce195ad9514c-0f1130c9e9de1ebe839a12546186ef3e/tiles/{z}/{x}/{y}","RGB","RGB",{"minZoom":0,"maxZoom":24,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addLayersControl","args":[["CartoDB.Positron","OpenStreetMap","CartoDB.DarkMatter","Esri.WorldImagery","OpenTopoMap"],"RGB",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"hideGroup","args":[null]},{"method":"addTiles","args":["https://earthengine.googleapis.com/v1alpha/projects/earthengine-legacy/maps/1960c85824ac9610f46f625944df900e-324f582a1d9a91d46dbf48f503211c4e/tiles/{z}/{x}/{y}","NDWI","NDWI",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addLayersControl","args":[["CartoDB.Positron","OpenStreetMap","CartoDB.DarkMatter","Esri.WorldImagery","OpenTopoMap"],["RGB","NDWI"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"hideGroup","args":[null]}],"setView":[[-33.8444080918941,-70.9140156500011],13,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
</section>
<section id="construcción-de-un-mosaico-con-ndwi-y-falso-color" class="level3" data-number="7.4.4">
<h3 data-number="7.4.4" class="anchored" data-anchor-id="construcción-de-un-mosaico-con-ndwi-y-falso-color"><span class="header-section-number">7.4.4</span> Construcción de un Mosaico con NDWI y Falso Color</h3>
<p>Con el producto anterior se procederá a construir un mosaico con la imagen de el índice de agua y la composición falso color para mostrar sus resultados posteriormente en un mapa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>imageRGB <span class="ot">&lt;-</span> imagen<span class="sc">$</span><span class="fu">visualize</span>(<span class="at">bands =</span> <span class="fu">c</span>(<span class="st">'B5'</span>, <span class="st">'B4'</span>, <span class="st">'B3'</span>), <span class="at">max =</span> <span class="fl">0.5</span>, <span class="at">gamma =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">1.1</span>, <span class="dv">1</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ndwiRGB <span class="ot">&lt;-</span> ndwiMask<span class="sc">$</span><span class="fu">visualize</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">'#00FFFF'</span>, <span class="st">'#0000FF'</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>mosaic <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">ImageCollection</span>(<span class="fu">c</span>(imageRGB, ndwiRGB))<span class="sc">$</span><span class="fu">mosaic</span>() <span class="co">#función crea mo</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">centerObject</span>(region, <span class="at">zoom =</span> <span class="dv">13</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">addLayer</span>(mosaic , <span class="fu">list</span>(), <span class="st">'mosaic'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-336658a3dd8539ed3a5f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-336658a3dd8539ed3a5f">{"x":{"options":{"minZoom":1,"maxZoom":24,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane","maxZoom":24}]},{"method":"addLayersControl","args":[["CartoDB.Positron","OpenStreetMap","CartoDB.DarkMatter","Esri.WorldImagery","OpenTopoMap"],[],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addTiles","args":["https://earthengine.googleapis.com/v1alpha/projects/earthengine-legacy/maps/0829eb131b14f52dd1c709578303d885-20f4c9bc85317486b433b67454cad73b/tiles/{z}/{x}/{y}","mosaic","mosaic",{"minZoom":0,"maxZoom":24,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addLayersControl","args":[["CartoDB.Positron","OpenStreetMap","CartoDB.DarkMatter","Esri.WorldImagery","OpenTopoMap"],"mosaic",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"hideGroup","args":[null]}],"setView":[[-33.8444080918941,-70.9140156500011],13,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
</section>
<section id="creación-de-serie-anual-desde-el-2015-al-2020" class="level3" data-number="7.4.5">
<h3 data-number="7.4.5" class="anchored" data-anchor-id="creación-de-serie-anual-desde-el-2015-al-2020"><span class="header-section-number">7.4.5</span> Creación de Serie Anual desde el 2015 al 2020</h3>
<p>Finalmente lo que se desea es aplicar el procedimiento anterior pero para cada uno de los años de una serie anual de forma automatizada aplicando una función.</p>
<p>Cómo primer paso se procede a la generación de la colección de imágenes <a href="https://developers.google.com/earth-engine/datasets/catalog/landsat-8">Landsat 8</a> que se utilizarán para el generar la serie anual.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>imagen <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">ImageCollection</span>(<span class="st">'LANDSAT/LC08/C01/T1_TOA'</span>)<span class="sc">$</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterBounds</span>(region)<span class="sc">$</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterDate</span>(<span class="st">'2015-01-01'</span>,<span class="st">'2020-12-31'</span>)<span class="sc">$</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filterMetadata</span>(<span class="st">'CLOUD_COVER'</span>,<span class="st">'less_than'</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Definición de la secuencia de años en formato ee.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>anual <span class="ot">&lt;-</span> ee<span class="sc">$</span>List<span class="sc">$</span><span class="fu">sequence</span>(<span class="dv">2015</span>, <span class="dv">2020</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generación de una función que permite extraer anualmente la colección de imágenes se le aplique la mediana, se capturé tres bandas <code>("B4", "B3", "B2")</code> y finalmente se corte por la región todo esto será aplicado por cada uno de los años.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>anual_l8 <span class="ot">&lt;-</span> <span class="cf">function</span>(y) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  imagen<span class="sc">$</span><span class="fu">filter</span>(ee<span class="sc">$</span>Filter<span class="sc">$</span><span class="fu">calendarRange</span>(y, y, <span class="st">"year"</span>))<span class="sc">$</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>()<span class="sc">$</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">"B4"</span>, <span class="st">"B3"</span>, <span class="st">"B2"</span>)<span class="sc">$</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clip</span>(region)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aplicación de la función (<code>anual_l8()</code>) por cada uno de los años contenido en la secuencia, de forma iterativa, guardando todo en uno objeto del cual se podrán extraer sus resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>l8_year <span class="ot">&lt;-</span> anual<span class="sc">$</span><span class="fu">map</span>(<span class="fu">ee_utils_pyfunc</span>(anual_l8))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Extracción de los resultados anuales independientes para facilitar la generación de Mapas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>l8_year_2015 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(l8_year<span class="sc">$</span><span class="fu">get</span>(<span class="dv">0</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>l8_year_2016 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(l8_year<span class="sc">$</span><span class="fu">get</span>(<span class="dv">1</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>l8_year_2017 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(l8_year<span class="sc">$</span><span class="fu">get</span>(<span class="dv">2</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>l8_year_2018 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(l8_year<span class="sc">$</span><span class="fu">get</span>(<span class="dv">3</span>))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>l8_year_2019 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(l8_year<span class="sc">$</span><span class="fu">get</span>(<span class="dv">4</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>l8_year_2020 <span class="ot">&lt;-</span> ee<span class="sc">$</span><span class="fu">Image</span>(l8_year<span class="sc">$</span><span class="fu">get</span>(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generación de Mapas por cada uno de los años considerandos en la serie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>visparams <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">bands =</span> <span class="fu">c</span>(<span class="st">"B4"</span>, <span class="st">"B3"</span>, <span class="st">"B2"</span>), <span class="at">min =</span> <span class="dv">0</span>,<span class="at">max =</span> <span class="fl">0.6</span>,<span class="at">gamma =</span> <span class="fl">1.4</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>Map<span class="sc">$</span><span class="fu">centerObject</span>(region, <span class="at">zoom =</span> <span class="dv">13</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> Map<span class="sc">$</span><span class="fu">addLayer</span>(l8_year_2015, visparams, <span class="at">name =</span> <span class="st">"2015"</span>)<span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  Map<span class="sc">$</span><span class="fu">addLayer</span>(l8_year_2016, visparams, <span class="at">name =</span> <span class="st">"2016"</span>)<span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  Map<span class="sc">$</span><span class="fu">addLayer</span>(l8_year_2017, visparams, <span class="at">name =</span> <span class="st">"2017"</span>)<span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  Map<span class="sc">$</span><span class="fu">addLayer</span>(l8_year_2018, visparams, <span class="at">name =</span> <span class="st">"2018"</span>)<span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  Map<span class="sc">$</span><span class="fu">addLayer</span>(l8_year_2019, visparams, <span class="at">name =</span> <span class="st">"2019"</span>)<span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  Map<span class="sc">$</span><span class="fu">addLayer</span>(l8_year_2019, visparams, <span class="at">name =</span> <span class="st">"2020"</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>map1</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># referencias: # https://github.com/r-spatial/rgee/blob/examples/ImageCollection/creating_monthly_imagery.R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="referencias" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="referencias"><span class="header-section-number">7.5</span> Referencias</h2>
<ul>
<li><p><a href="https://www.geo.university/pages/spectral-indices-in-remote-sensing-and-how-to-interpret-them">A initial approach on how to understand spectral indices</a></p></li>
<li><p><a href="https://medium.com/@behasg_geo/spectral-indices-in-remote-sensing-part-1-729ec313feff">Spectral indices in remote sensing- part-1</a></p></li>
<li><p><a href="https://www.nature.com/articles/s41597-023-02096-0">A standardized catalogue of spectral indices to advance the use of remote sensing in Earth system research</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./proc_gee.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">S4: Procesamiento con GEE</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./tarea_1.html" class="pagination-link">
        <span class="nav-page-text">Tarea 1</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Denis Berroeta</div>   
  </div>
</footer>



</body></html>